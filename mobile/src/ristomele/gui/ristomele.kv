#:import ListAdapter kivy.adapters.listadapter.ListAdapter
#:import Factory kivy.factory.Factory
#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import icon kivy.garden.iconfonts.icon
#:import XCamera kivy.garden.xcamera.XCamera
#:import darker kivy.garden.xcamera.darker
#:import Theme ristomele.gui.uix.Theme

# =====================================================================
# common styles
# =====================================================================


<FlatButton>:
    background_color: (1, 1, 1, 1)
    _down_color: darker(self.background_color)
    color: Theme.ICON

    canvas.before:
        Color:
            rgba: self.background_color if self.state == 'normal' else self._down_color
        Rectangle:
            pos: self.pos
            size: self.size


<IconButton@FlatButton>:
    icon: ""
    markup: True
    color: Theme.ICON
    text: icon(self.icon) if self.icon else ""
    size_hint_x: None
    width: self.height


# =====================================================================
# tables.py
# =====================================================================

<Table@Button>:
    background_color: (1.0, 0.0, 0.0, 1.0) if self.busy else (0.0, 1.0, 0.0, 1.0)
    on_release: app.new_order(self)

<Tables>:
    BoxLayout:
        id: layout
        orientation: 'vertical'

        Label:
            text: "Mappa dei tavoli"
            size_hint_y: None


# =====================================================================
# menu.py
# =====================================================================

<MenuItem@BoxLayout>:
    orientation: 'horizontal'
    height: '50dp'
    size_hint_y: None

    Label:
        text: self.parent.name
        text_size: self.size
        padding_x: 20

    BoxLayout:
        orientation: 'horizontal'
        Button:
            text: "-"
            on_release: root.count = max(root.count-1, 0)

        Label:
            text: str(root.count)

        Button:
            text: "+"
            on_release: root.count += 1

<MenuSeparator@Label>:
    height: '50dp'
    text_size: self.size
    valign: "bottom"
    padding_x: 10

<Menu>:
    BoxLayout:
        id: layout
        orientation: 'vertical'

        Label:
            text: "Tavolo: %s" % root.table.text
            size_hint_y: None
            height: '50dp'

        TextInput:
            hint_text: 'Nome'
            size_hint_y: None
            height: '40dp'

        ListView:
            id: item_list
            adapter: ListAdapter(data=root.items, cls=lambda x, index: x, args_converter=lambda i, x: {'x': x})

        Button:
            text: "Invia ordine"
            size_hint_y: None
            height: '40dp'
            on_release: app.submit_menu(root)
